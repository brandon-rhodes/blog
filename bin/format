#!/usr/bin/env python

import datetime  # needed when running eval() on dictionary
import sys
from bottle import SimpleTemplate

rst_overrides = {'initial_header_level': 2}

if __name__ == '__main__':
    in_path, out_path = sys.argv[1:]

    with open(in_path) as f:
        dict_text = f.read()

    info = eval(dict_text)
    in_html = info['html_body']
    in_html += u'\n%rebase layout title="{}"\n'.format(info['title'])

    tpl = SimpleTemplate(in_html, lookup=['templates'])
    out_html = tpl.render()
    open(out_path, 'w').write(out_html.encode('utf-8'))
